{
  "entityType" : "RULE_CHAIN",
  "entity" : {
    "additionalInfo" : {
      "description" : "despues de crear el asset tipo measurement point y agregar las relaciones al device se le agrega 1 atributo llamado measurment point name para ser usado en el mapa por zona donde agrupan los sensores para cada profundidad. Este nombre del punto de medici√≥n corresponde al nombre de la serie en esos graficos\n\nDREPECATED\nDado que no fue posible encontrar la forma de al crear desde el asset la relacion de los devices en conjunto, tome cada uno por separado, esta rule engine queda en este estado"
    },
    "configuration" : null,
    "debugMode" : false,
    "externalId" : {
      "entityType" : "RULE_CHAIN",
      "id" : "84b5b6f0-a383-11f0-8ada-cb2dc6e9b0fb"
    },
    "firstRuleNodeId" : {
      "entityType" : "RULE_NODE",
      "id" : "c775b930-a38e-11f0-8ada-cb2dc6e9b0fb"
    },
    "id" : {
      "entityType" : "RULE_CHAIN",
      "id" : "84b5b6f0-a383-11f0-8ada-cb2dc6e9b0fb"
    },
    "name" : "set-measurement-point-name-attr-to-device-after-create-relation-asset DEPRECATED",
    "root" : false,
    "type" : "CORE"
  },
  "metaData" : {
    "connections" : [ {
      "fromIndex" : 1,
      "toIndex" : 2,
      "type" : "Success"
    }, {
      "fromIndex" : 2,
      "toIndex" : 4,
      "type" : "output"
    }, {
      "fromIndex" : 3,
      "toIndex" : 11,
      "type" : "Success"
    }, {
      "fromIndex" : 3,
      "toIndex" : 12,
      "type" : "Success"
    }, {
      "fromIndex" : 3,
      "toIndex" : 15,
      "type" : "Success"
    }, {
      "fromIndex" : 4,
      "toIndex" : 5,
      "type" : "Success"
    }, {
      "fromIndex" : 6,
      "toIndex" : 3,
      "type" : "Success"
    }, {
      "fromIndex" : 8,
      "toIndex" : 9,
      "type" : "Success"
    }, {
      "fromIndex" : 10,
      "toIndex" : 8,
      "type" : "Success"
    }, {
      "fromIndex" : 11,
      "toIndex" : 10,
      "type" : "Success"
    }, {
      "fromIndex" : 11,
      "toIndex" : 14,
      "type" : "Success"
    }, {
      "fromIndex" : 12,
      "toIndex" : 13,
      "type" : "Success"
    } ],
    "firstNodeIndex" : 3,
    "nodes" : [ {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 213,
        "layoutY" : 410
      },
      "configuration" : {
        "scriptLang" : "JS",
        "jsScript" : "return '\\nIncoming message:\\n' + JSON.stringify(msg) + '\\nIncoming metadata:\\n' + JSON.stringify(metadata);",
        "tbelScript" : "return '\\nIncoming message:\\n' + JSON.stringify(msg) + '\\nIncoming metadata:\\n' + JSON.stringify(metadata);"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760710760570,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "9dbc52d0-a388-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "log",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.action.TbLogNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 694,
        "layoutY" : 734
      },
      "configuration" : {
        "originatorSource" : "ENTITY",
        "entityType" : "DEVICE",
        "entityNamePattern" : "${relatedEntityNombre}",
        "relationsQuery" : {
          "fetchLastLevelOnly" : false,
          "direction" : "FROM",
          "maxLevel" : 1,
          "filters" : [ {
            "relationType" : "Contains",
            "entityTypes" : [ "DEVICE" ]
          } ]
        }
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760711691712,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "c8c6a000-a38a-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change to device",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbChangeOriginatorNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1084,
        "layoutY" : 637
      },
      "configuration" : {
        "forwardMsgToDefaultRuleChain" : false,
        "ruleChainId" : "8e323790-a38c-11f0-8ada-cb2dc6e9b0fb"
      },
      "configurationVersion" : 1,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760712878295,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "723f4270-a38d-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "origintator attributes",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 685,
        "layoutY" : 147
      },
      "configuration" : {
        "renameIn" : "METADATA",
        "renameKeysMapping" : {
          "originatorName" : "assetOriginatorName",
          "originatorType" : "assetOriginatorType",
          "originatorId" : "assetOriginatorId"
        }
      },
      "configurationVersion" : 2,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760713407490,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "c775b930-a38e-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "rename originator fields",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbRenameKeysNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1366,
        "layoutY" : 730
      },
      "configuration" : {
        "scriptLang" : "JS",
        "jsScript" : "var new_msg = {\n    \"measurement-point-name\":metadata.assetOriginatorName\n}\nreturn {msg: new_msg, metadata: metadata, msgType: 'POST_ATTRIBUTES_REQUEST'};",
        "tbelScript" : "return {msg: msg, metadata: metadata, msgType: msgType};"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760714687479,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "c25c9c40-a391-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change msg type",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1667,
        "layoutY" : 681
      },
      "configuration" : {
        "processingSettings" : {
          "type" : "ON_EVERY_MESSAGE"
        },
        "scope" : "SERVER_SCOPE",
        "notifyDevice" : false,
        "sendAttributesUpdatedNotification" : false,
        "updateAttributesOnlyOnValueChange" : true
      },
      "configurationVersion" : 3,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760714778047,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "f85830c0-a391-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "save attribute",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 303,
        "layoutY" : 296
      },
      "configuration" : {
        "relationsQuery" : {
          "fetchLastLevelOnly" : false,
          "direction" : "FROM",
          "maxLevel" : 1,
          "filters" : [ {
            "relationType" : "Contains",
            "entityTypes" : [ "DEVICE" ]
          } ]
        },
        "dataToFetch" : "FIELDS",
        "fetchTo" : "METADATA",
        "dataMapping" : {
          "name" : "relatedEntityNombre",
          "id" : "relatedEntityId"
        }
      },
      "configurationVersion" : 1,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760717096362,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "5e2b98b0-a397-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "get device name",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.metadata.TbGetRelatedAttributeNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 522,
        "layoutY" : 523
      },
      "configuration" : {
        "originatorSource" : "RELATED",
        "entityType" : null,
        "entityNamePattern" : null,
        "relationsQuery" : {
          "fetchLastLevelOnly" : false,
          "direction" : "FROM",
          "maxLevel" : 1,
          "filters" : [ {
            "relationType" : "Contains",
            "entityTypes" : [ "DEVICE" ]
          } ]
        }
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760717208059,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "a0bd8710-a397-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change to device",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbChangeOriginatorNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1594,
        "layoutY" : 167
      },
      "configuration" : {
        "scriptLang" : "JS",
        "jsScript" : "metadata.relation = JSON.stringify(msg);\n//metadata.entityId = msg.to.id;\nvar new_msg = {\n    \"measurement-point-name\":metadata.assetOriginatorName\n}\nreturn {msg: new_msg, metadata: metadata, msgType: 'POST_ATTRIBUTES_REQUEST'};",
        "tbelScript" : "return {msg: msg, metadata: metadata, msgType: msgType};"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760719218203,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "4ee1c550-a39c-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change msg type",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1696,
        "layoutY" : 361
      },
      "configuration" : {
        "processingSettings" : {
          "attributes" : {
            "type" : "ON_EVERY_MESSAGE"
          },
          "webSockets" : {
            "type" : "ON_EVERY_MESSAGE"
          },
          "calculatedFields" : {
            "type" : "ON_EVERY_MESSAGE"
          },
          "type" : "ADVANCED"
        },
        "scope" : "SERVER_SCOPE",
        "notifyDevice" : false,
        "sendAttributesUpdatedNotification" : false,
        "updateAttributesOnlyOnValueChange" : true
      },
      "configurationVersion" : 3,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760719218203,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "4ee2d6c0-a39c-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "save attribute",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.telemetry.TbMsgAttributesNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1331,
        "layoutY" : 62
      },
      "configuration" : {
        "dataMapping" : {
          "id" : "entityId"
        },
        "ignoreNullStrings" : false,
        "fetchTo" : "METADATA"
      },
      "configurationVersion" : 1,
      "createdTime" : 0,
      "debugSettings" : null,
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "e3554b60-a3a3-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "add entityId to metadata",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.metadata.TbGetOriginatorFieldsNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 986,
        "layoutY" : 179
      },
      "configuration" : {
        "originatorSource" : "ENTITY",
        "entityType" : "DEVICE",
        "entityNamePattern" : "${relatedEntityNombre}",
        "relationsQuery" : {
          "fetchLastLevelOnly" : false,
          "direction" : "FROM",
          "maxLevel" : 1,
          "filters" : [ {
            "relationType" : "Contains",
            "entityTypes" : [ "DEVICE" ]
          } ]
        }
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760723487381,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "3f8206b0-a3a6-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change to device",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbChangeOriginatorNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 979,
        "layoutY" : 396
      },
      "configuration" : {
        "originatorSource" : "RELATED",
        "entityType" : null,
        "entityNamePattern" : null,
        "relationsQuery" : {
          "fetchLastLevelOnly" : false,
          "direction" : "FROM",
          "maxLevel" : 1,
          "filters" : [ {
            "relationType" : "Contains",
            "entityTypes" : [ "DEVICE" ]
          } ]
        }
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760725929200,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "eef23070-a3ab-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change to device",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbChangeOriginatorNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1286,
        "layoutY" : 423
      },
      "configuration" : {
        "forwardMsgToDefaultRuleChain" : false,
        "ruleChainId" : "8e323790-a38c-11f0-8ada-cb2dc6e9b0fb"
      },
      "configurationVersion" : 1,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760726312947,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "d3ac9250-a3ac-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "origintator attributes",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 1250,
        "layoutY" : 259
      },
      "configuration" : {
        "forwardMsgToDefaultRuleChain" : false,
        "ruleChainId" : "8e323790-a38c-11f0-8ada-cb2dc6e9b0fb"
      },
      "configurationVersion" : 1,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760726312947,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "d3acb960-a3ac-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "origintator attributes",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.flow.TbRuleChainInputNode"
    }, {
      "additionalInfo" : {
        "description" : "",
        "layoutX" : 939,
        "layoutY" : 30
      },
      "configuration" : {
        "scriptLang" : "JS",
        "jsScript" : "metadata.newOriginatorType = \"DEVICE\";\nreturn {msg: msg, metadata: metadata, msgType: msgType};",
        "tbelScript" : "return {msg: msg, metadata: metadata, msgType: msgType};"
      },
      "configurationVersion" : 0,
      "createdTime" : 0,
      "debugSettings" : {
        "allEnabled" : false,
        "allEnabledUntil" : 1760726816472,
        "failuresEnabled" : false
      },
      "externalId" : null,
      "id" : {
        "entityType" : "RULE_NODE",
        "id" : "ffcc8ab0-a3ad-11f0-8ada-cb2dc6e9b0fb"
      },
      "name" : "change originator script",
      "queueName" : null,
      "ruleChainId" : null,
      "singletonMode" : false,
      "type" : "org.thingsboard.rule.engine.transform.TbTransformMsgNode"
    } ],
    "ruleChainConnections" : null
  },
  "relations" : [ {
    "additionalInfo" : null,
    "from" : {
      "entityType" : "RULE_CHAIN",
      "id" : "84b5b6f0-a383-11f0-8ada-cb2dc6e9b0fb"
    },
    "to" : {
      "entityType" : "RULE_CHAIN",
      "id" : "8e323790-a38c-11f0-8ada-cb2dc6e9b0fb"
    },
    "type" : "Uses",
    "typeGroup" : "COMMON",
    "version" : 14687
  }, {
    "additionalInfo" : null,
    "from" : {
      "entityType" : "RULE_CHAIN",
      "id" : "b763a7a0-9a2e-11f0-8ada-cb2dc6e9b0fb"
    },
    "to" : {
      "entityType" : "RULE_CHAIN",
      "id" : "84b5b6f0-a383-11f0-8ada-cb2dc6e9b0fb"
    },
    "type" : "Uses",
    "typeGroup" : "COMMON",
    "version" : 14717
  } ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}